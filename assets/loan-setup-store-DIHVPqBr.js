import{a as c,p as d}from"./middleware-DdPu8O1F.js";import{v as i}from"./v4-EwEgHOG0.js";var b=(e=>(e.MONTH="Month",e.YEAR="Year",e.DAY="Day",e))(b||{});const u=e=>({interestType:e.interestType,rateType:e.rateType,baseRate:e.baseRate,config:{parameters:(e.config?.parameters??[]).map(s=>({name:s.name,value:s.value,interestRate:s.interestRate}))},policies:(e.policies??[]).map(s=>({interestCategory:s.interestCategory,interestRate:s.interestRate}))}),R=(e=0)=>({interestType:"REDUCING",rateType:"FIXED",baseRate:e,config:{parameters:[]},policies:[]}),y=e=>{if(e.interestRatePlans&&e.interestRatePlans.length>0)return(e.interestRatePlans??[]).map(u);const r=typeof e.baseInterestRate=="number"?e.baseInterestRate:0;return[u(R(r))]};function o(e){const s=y(e);return{...e,loanTenor:{...e.loanTenor,TenorValue:[...e.loanTenor.TenorValue]},interestRatePlans:s,baseInterestRate:s[0]?.baseRate??e.baseInterestRate}}const p=c()(d((e,s)=>({setups:{},addSetup:r=>{const a=(r.channels??[]).map(t=>({name:t.name.trim(),code:t.code.trim()})).filter(t=>t.name||t.code),n={id:i(),createdAt:Date.now(),product:o(r.product),channels:a,scorecardId:r.scorecardId??null,scorecardName:r.scorecardName??null,workflowId:r.workflowId??null,workflowName:r.workflowName??null,riskGrade:r.riskResult?.riskGrade??null,totalScore:r.riskResult?.totalScore??null,disbursementType:r.disbursementType??"FULL",partialInterestRate:r.disbursementType==="PARTIAL"?r.partialInterestRate??null:null,disbursementDestinations:(r.disbursementDestinations??[]).filter(t=>t?.type==="BANK"||t?.type==="WALLET"),repaymentPlanId:r.repaymentPlan?.planId??null,repaymentPlanName:r.repaymentPlan?.name??null,repaymentPlan:r.repaymentPlan?{...r.repaymentPlan}:null,bureauCheckRequired:r.bureauCheckRequired||!1,bureauConsentRequired:r.bureauConsentRequired||!1,bureauProvider:r.bureauProvider||null,bureauPurpose:r.bureauPurpose||null};return e(t=>({setups:{...t.setups,[n.id]:n}})),n},updateSetup:(r,a)=>{const n=s().setups[r];if(!n)return;const t=(a.channels??[]).map(l=>({name:l.name.trim(),code:l.code.trim()})).filter(l=>l.name||l.code),m={...n,product:o(a.product),channels:t,scorecardId:a.scorecardId??null,scorecardName:a.scorecardName??null,workflowId:a.workflowId??null,workflowName:a.workflowName??null,riskGrade:a.riskResult?.riskGrade??n.riskGrade,totalScore:a.riskResult?.totalScore??n.totalScore,disbursementType:a.disbursementType??"FULL",partialInterestRate:a.disbursementType==="PARTIAL"?a.partialInterestRate??null:null,disbursementDestinations:(a.disbursementDestinations??[]).filter(l=>l?.type==="BANK"||l?.type==="WALLET"),repaymentPlanId:a.repaymentPlan?.planId??null,repaymentPlanName:a.repaymentPlan?.name??null,repaymentPlan:a.repaymentPlan?{...a.repaymentPlan}:null,bureauCheckRequired:a.bureauCheckRequired||!1,bureauConsentRequired:a.bureauConsentRequired||!1,bureauProvider:a.bureauProvider||null,bureauPurpose:a.bureauPurpose||null};e(l=>({setups:{...l.setups,[r]:m}}))},resetStore:()=>e({setups:{}})}),{name:"loan-workflow-setups",version:2,migrate:(e,s)=>{if(!e)return{setups:{}};if(s>=2)return e;const r=e.setups??{},a=Object.entries(r).map(([n,t])=>t?.product?[n,{...t,product:o(t.product)}]:[n,t]);return{...e,setups:Object.fromEntries(a)}},partialize:e=>({setups:e.setups})}));function I(e){return Object.values(e).sort((s,r)=>r.createdAt-s.createdAt)}export{b as T,o as c,I as g,p as u};
