import{r,j as e,L as y}from"./main-CTZC3Rfw.js";import{u as n,g}from"./repayment-setup-store-XkKrmJW1.js";import"./middleware-wB-HpbGX.js";import"./v4-EwEgHOG0.js";const m={name:"",description:"",method:"EMI",frequency:"MONTHLY",dueDayOfMonth:5,firstDueAfterDays:30,gracePeriodDays:5,lateFeeFlat:0,lateFeePct:0,prepaymentPenaltyPct:0,autopayRequired:!1,roundingStep:100,minInstallmentAmount:null};function P(){const d=n(s=>s.plans),p=n(s=>s.selectedPlanId),u=n(s=>s.addPlan),c=n(s=>s.selectPlan),h=n(s=>s.removePlan),i=r.useMemo(()=>g(d),[d]),[t,l]=r.useState(m),[o,x]=r.useState(null),j=s=>{s.preventDefault(),x(null);try{const a=u({...t,name:t.name.trim(),description:t.description?.trim()||""});c(a.planId),l(m)}catch(a){x(a instanceof Error?a.message:"Unable to save plan")}};return e.jsxs("div",{className:"p-6 font-sans max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Repayment Setup"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Define repayment plans that can be reused in Loan Setup."})]}),e.jsx(y,{to:"/loan/setup",className:"text-sm border px-3 py-1 rounded hover:bg-gray-50",children:"Back to Loan Setup"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1.4fr_1fr]",children:[e.jsxs("section",{className:"border p-4 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"font-semibold",children:"New repayment plan"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Persisted via Zustand"})]}),e.jsxs("form",{className:"space-y-3",onSubmit:j,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>l(a=>({...a,name:s.target.value})),className:"border px-2 py-2 rounded",placeholder:"e.g. Monthly EMI",required:!0})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Method"}),e.jsxs("select",{value:t.method,onChange:s=>l(a=>({...a,method:s.target.value})),className:"border px-2 py-2 rounded",children:[e.jsx("option",{value:"EMI",children:"EMI (amortized)"}),e.jsx("option",{value:"INTEREST_ONLY",children:"Interest only"}),e.jsx("option",{value:"BULLET",children:"Bullet"})]})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Frequency"}),e.jsxs("select",{value:t.frequency,onChange:s=>l(a=>({...a,frequency:s.target.value})),className:"border px-2 py-2 rounded",children:[e.jsx("option",{value:"WEEKLY",children:"Weekly"}),e.jsx("option",{value:"BIWEEKLY",children:"Bi-weekly"}),e.jsx("option",{value:"MONTHLY",children:"Monthly"}),e.jsx("option",{value:"QUARTERLY",children:"Quarterly"})]})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Due day (1-28, monthly)"}),e.jsx("input",{type:"number",min:1,max:28,value:t.dueDayOfMonth??"",onChange:s=>l(a=>({...a,dueDayOfMonth:s.target.value?Number(s.target.value):null})),className:"border px-2 py-2 rounded",placeholder:"e.g. 5"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"First due after (days)"}),e.jsx("input",{type:"number",min:0,value:t.firstDueAfterDays??"",onChange:s=>l(a=>({...a,firstDueAfterDays:Number(s.target.value)})),className:"border px-2 py-2 rounded",placeholder:"30"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Grace period (days)"}),e.jsx("input",{type:"number",min:0,value:t.gracePeriodDays??"",onChange:s=>l(a=>({...a,gracePeriodDays:Number(s.target.value)})),className:"border px-2 py-2 rounded",placeholder:"5"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Late fee flat"}),e.jsx("input",{type:"number",min:0,value:t.lateFeeFlat??"",onChange:s=>l(a=>({...a,lateFeeFlat:Number(s.target.value)})),className:"border px-2 py-2 rounded",placeholder:"0"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Late fee (%)"}),e.jsx("input",{type:"number",step:.1,min:0,value:t.lateFeePct??"",onChange:s=>l(a=>({...a,lateFeePct:Number(s.target.value)})),className:"border px-2 py-2 rounded",placeholder:"1"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Prepayment penalty (%)"}),e.jsx("input",{type:"number",step:.1,min:0,value:t.prepaymentPenaltyPct??"",onChange:s=>l(a=>({...a,prepaymentPenaltyPct:Number(s.target.value)})),className:"border px-2 py-2 rounded",placeholder:"2"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Rounding step"}),e.jsx("input",{type:"number",min:1,value:t.roundingStep??"",onChange:s=>l(a=>({...a,roundingStep:Number(s.target.value)})),className:"border px-2 py-2 rounded",placeholder:"100"})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Min installment amount"}),e.jsx("input",{type:"number",min:0,value:t.minInstallmentAmount??"",onChange:s=>l(a=>({...a,minInstallmentAmount:s.target.value?Number(s.target.value):null})),className:"border px-2 py-2 rounded",placeholder:"optional"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:t.autopayRequired,onChange:s=>l(a=>({...a,autopayRequired:s.target.checked})),className:"accent-blue-600"}),e.jsx("span",{children:"Autopay required"})]})]}),e.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[e.jsx("span",{children:"Description"}),e.jsx("textarea",{value:t.description,onChange:s=>l(a=>({...a,description:s.target.value})),className:"border px-2 py-2 rounded",rows:3,placeholder:"Notes for ops team"})]}),o&&e.jsx("div",{className:"text-sm text-red-700 bg-red-50 border border-red-200 rounded p-2",children:o}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700",children:"Save plan"})})]})]}),e.jsxs("section",{className:"border p-4 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"font-semibold",children:"Saved plans"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Select to use in Loan Setup"})]}),i.length===0?e.jsx("div",{className:"text-sm text-gray-700",children:"No plans yet."}):e.jsx("div",{className:"space-y-3",children:i.map(s=>e.jsxs("div",{className:`border rounded p-3 text-sm ${p===s.planId?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:[s.method," · ",s.frequency]}),s.description?e.jsx("div",{className:"text-xs text-gray-700 mt-1",children:s.description}):null]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>c(s.planId),className:"text-sm border px-3 py-1 rounded hover:bg-gray-100",children:"Use"}),e.jsx("button",{type:"button",onClick:()=>h(s.planId),className:"text-sm border px-3 py-1 rounded hover:bg-gray-100",children:"Delete"})]})]}),e.jsxs("dl",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-2 text-xs text-gray-700",children:[e.jsxs("div",{children:[e.jsx("dt",{children:"Due day"}),e.jsx("dd",{children:s.dueDayOfMonth??"—"})]}),e.jsxs("div",{children:[e.jsx("dt",{children:"Grace period"}),e.jsxs("dd",{children:[s.gracePeriodDays," days"]})]}),e.jsxs("div",{children:[e.jsx("dt",{children:"Late fee"}),e.jsxs("dd",{children:[s.lateFeeFlat.toLocaleString()," + ",s.lateFeePct,"%"]})]}),e.jsxs("div",{children:[e.jsx("dt",{children:"Prepayment"}),e.jsxs("dd",{children:[s.prepaymentPenaltyPct,"%"]})]}),e.jsxs("div",{children:[e.jsx("dt",{children:"Rounding"}),e.jsx("dd",{children:s.roundingStep})]}),e.jsxs("div",{children:[e.jsx("dt",{children:"Autopay"}),e.jsx("dd",{children:s.autopayRequired?"Required":"Optional"})]})]})]},s.planId))})]})]})]})}export{P as component};
