import{a as m,p as o}from"./middleware-DdPu8O1F.js";import{v as c}from"./v4-EwEgHOG0.js";const i=a=>{if(!Number.isFinite(a))return null;const n=Number(a);return n<1?1:n>28?28:n},s=(a,n)=>Number.isFinite(a)?Number(a):n,r={planId:"plan-standard-emi",name:"Standard EMI",description:"Monthly equal installments with a short grace period and small prepayment fee.",method:"EMI",frequency:"MONTHLY",dueDayOfMonth:5,firstDueAfterDays:30,gracePeriodDays:5,lateFeeFlat:7500,lateFeePct:1,prepaymentPenaltyPct:2,autopayRequired:!0,roundingStep:100,minInstallmentAmount:null,createdAt:Date.now()},y=m()(o((a,n)=>({plans:{[r.planId]:r},selectedPlanId:r.planId,addPlan:e=>{const t=e.name.trim();if(!t)throw new Error("Repayment plan name is required");const l={planId:c(),name:t,description:e.description?.trim()||void 0,method:e.method??"EMI",frequency:e.frequency??"MONTHLY",dueDayOfMonth:i(e.dueDayOfMonth??null),firstDueAfterDays:s(e.firstDueAfterDays,30),gracePeriodDays:s(e.gracePeriodDays,5),lateFeeFlat:Math.max(0,s(e.lateFeeFlat,0)),lateFeePct:Math.max(0,s(e.lateFeePct,0)),prepaymentPenaltyPct:Math.max(0,s(e.prepaymentPenaltyPct,0)),autopayRequired:e.autopayRequired??!1,roundingStep:Math.max(1,s(e.roundingStep,1)),minInstallmentAmount:Number.isFinite(e.minInstallmentAmount)?Math.max(0,Number(e.minInstallmentAmount)):null,createdAt:Date.now()};return a(d=>({plans:{...d.plans,[l.planId]:l},selectedPlanId:l.planId})),l},removePlan:e=>{a(t=>{if(!t.plans[e])return t;const l={...t.plans};delete l[e];const d=Object.keys(l).length>0;return{plans:d?l:{[r.planId]:r},selectedPlanId:t.selectedPlanId===e?d?Object.keys(l)[0]:r.planId:t.selectedPlanId}})},selectPlan:e=>{a(t=>e?t.plans[e]?{selectedPlanId:e}:t:{selectedPlanId:null})},resetStore:()=>a({plans:{[r.planId]:r},selectedPlanId:r.planId})}),{name:"loan-repayment-plans",version:1,partialize:a=>({plans:a.plans,selectedPlanId:a.selectedPlanId})}));function P(a){return Object.values(a).sort((n,e)=>{const t=n.name.localeCompare(e.name);return t!==0?t:n.createdAt-e.createdAt})}export{P as g,y as u};
