import{c as O,r as y,j as e}from"./main-2DWcc1qD.js";import{T as G}from"./loan-setup-store-DIHVPqBr.js";import{T as m}from"./trash-2-CBKpMMCx.js";const L=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],v=O("chevron-right",L);function $(f){const{product:x,onUpdateTenureUnit:C,onAddTenureValue:R,onUpdateTenureValue:T,onRemoveTenureValue:P,onInterestPlansChange:u}=f,[g,w]=y.useState(!0),[b,k]=y.useState(!0),l=x.interestRatePlans??[],i=(t,s)=>{u(l.map((a,r)=>r===t?s(a):a))},V=()=>{const s=(l.length?l[l.length-1]:void 0)?.baseRate??x.baseInterestRate??0;u([...l,{interestType:"REDUCING",rateType:"FIXED",baseRate:s,config:{parameters:[]},policies:[]}])},F=t=>{l.length!==1&&u(l.filter((s,a)=>a!==t))},j=(t,s)=>a=>{i(t,r=>({...r,[s]:a.target.value}))},U=t=>s=>{const a=Number(s.target.value);i(t,r=>({...r,baseRate:Number.isFinite(a)?a:r.baseRate}))},A=t=>{i(t,s=>({...s,config:{parameters:[...s.config?.parameters??[],{name:"",value:0,interestRate:s.baseRate}]}}))},h=(t,s,a)=>r=>{const n=a==="name"?r.target.value:Number(r.target.value);i(t,d=>{const c=[...d.config?.parameters??[]],o=c[s];if(!o)return d;if(a==="name")c[s]={...o,name:n};else{const p=Number.isFinite(n)?n:o[a];c[s]={...o,[a]:p}}return{...d,config:{parameters:c}}})},E=(t,s)=>{i(t,a=>({...a,config:{parameters:(a.config?.parameters??[]).filter((r,n)=>n!==s)}}))},_=t=>{i(t,s=>({...s,policies:[...s.policies??[],{interestCategory:"",interestRate:0}]}))},N=(t,s,a)=>r=>{const n=a==="interestCategory"?r.target.value:Number(r.target.value);i(t,d=>{const c=[...d.policies??[]],o=c[s];if(!o)return d;if(a==="interestCategory")c[s]={...o,interestCategory:n};else{const p=Number.isFinite(n)?n:o.interestRate;c[s]={...o,interestRate:p}}return{...d,policies:c}})},D=(t,s)=>{i(t,a=>({...a,policies:(a.policies??[]).filter((r,n)=>n!==s)}))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>w(t=>!t),className:"w-full flex items-center justify-between px-3 py-2 bg-gray-100 text-sm font-semibold",children:[e.jsx("span",{children:"Tenor Configuration"}),e.jsx(v,{className:`w-4 h-4 transition-transform ${g?"rotate-90":"rotate-0"}`})]}),g&&e.jsxs("div",{className:"flex flex-col gap-2 border-t p-3 bg-white text-sm",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Unit"}),e.jsx("select",{value:x.loanTenor.TenorUnit,onChange:C,className:"border px-2 py-1 rounded w-full md:w-1/2",children:Object.values(G).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Values"}),e.jsx("button",{type:"button",onClick:R,className:"text-xs border px-2 py-1 rounded hover:bg-gray-50",children:"Add Value"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 w-full",children:x.loanTenor.TenorValue.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:t,onChange:T(s),className:"border px-2 py-1 rounded w-full",min:"0"}),e.jsx("button",{onClick:()=>P(s),className:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors",type:"button",title:"Remove",children:e.jsx(m,{className:"w-4 h-4"})})]},s))})]})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>k(t=>!t),className:"w-full flex items-center justify-between px-3 py-2 bg-gray-100 text-sm font-semibold",children:[e.jsx("span",{children:"Interest Rate Plans"}),e.jsx(v,{className:`w-4 h-4 transition-transform ${b?"rotate-90":"rotate-0"}`})]}),b&&e.jsxs("div",{className:"border-t p-3 bg-white text-sm space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Configure base rate, parameter overrides, and policies to match `interestRatePlans`."}),e.jsx("button",{type:"button",onClick:V,className:"text-xs border px-2 py-1 rounded hover:bg-gray-50",children:"Add Plan"})]}),l.length===0?e.jsx("div",{className:"text-xs text-gray-500 border border-dashed rounded p-3",children:"No plans configured yet."}):e.jsx("div",{className:"flex flex-col gap-3",children:l.map((t,s)=>e.jsxs("div",{className:"border rounded-md p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Plan ",s+1]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.interestType," - ",t.rateType]})]}),l.length>1&&e.jsx("button",{type:"button",onClick:()=>F(s),className:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors",title:"Remove plan",children:e.jsx(m,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Interest Type"}),e.jsx("select",{value:t.interestType,onChange:j(s,"interestType"),className:"border px-2 py-1 rounded",children:["REDUCING","FLAT"].map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Rate Type"}),e.jsx("select",{value:t.rateType,onChange:j(s,"rateType"),className:"border px-2 py-1 rounded",children:["FIXED","FLOATING"].map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Base Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",min:0,value:t.baseRate,onChange:U(s),className:"border px-2 py-1 rounded"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Parameters"}),e.jsx("button",{type:"button",onClick:()=>A(s),className:"text-xs border px-2 py-1 rounded hover:bg-gray-50",children:"Add Parameter"})]}),(t.config?.parameters??[]).length===0?e.jsx("div",{className:"text-xs text-gray-500 border border-dashed rounded p-2",children:"No parameter overrides. Will use base rate."}):e.jsx("div",{className:"space-y-2",children:(t.config?.parameters??[]).map((a,r)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 items-end",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Name"}),e.jsx("input",{type:"text",value:a.name,onChange:h(s,r,"name"),className:"border px-2 py-1 rounded"})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Value"}),e.jsx("input",{type:"number",value:a.value,min:0,onChange:h(s,r,"value"),className:"border px-2 py-1 rounded"})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Interest Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:a.interestRate,onChange:h(s,r,"interestRate"),className:"border px-2 py-1 rounded"})]}),e.jsx("button",{type:"button",onClick:()=>E(s,r),className:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors",title:"Remove parameter",children:e.jsx(m,{className:"w-4 h-4"})})]},r))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Policies"}),e.jsx("button",{type:"button",onClick:()=>_(s),className:"text-xs border px-2 py-1 rounded hover:bg-gray-50",children:"Add Policy"})]}),(t.policies??[]).length===0?e.jsx("div",{className:"text-xs text-gray-500 border border-dashed rounded p-2",children:"No policies attached."}):e.jsx("div",{className:"space-y-2",children:(t.policies??[]).map((a,r)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-end",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Category"}),e.jsx("input",{type:"text",value:a.interestCategory,onChange:N(s,r,"interestCategory"),className:"border px-2 py-1 rounded"})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Interest Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:a.interestRate,onChange:N(s,r,"interestRate"),className:"border px-2 py-1 rounded"})]}),e.jsx("button",{type:"button",onClick:()=>D(s,r),className:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors",title:"Remove policy",children:e.jsx(m,{className:"w-4 h-4"})})]},r))})]})]},s))})]})]})})]})}export{$ as T};
