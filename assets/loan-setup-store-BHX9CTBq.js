import{a as i,p as R}from"./middleware-DsRet5Ro.js";import{v as f}from"./v4-EwEgHOG0.js";var b=(r=>(r.MONTH="Month",r.YEAR="Year",r.DAY="Day",r))(b||{});const P=["NRC","PAYSLIP"],y=r=>{const a=new Set;return(r??[]).map(e=>e.trim()).filter(e=>{if(!e)return!1;const t=e.toLowerCase();return a.has(t)?!1:(a.add(t),!0)})},p=r=>{if(!r)return null;const a=y(r.documents);return a.length===0?null:{grade:r.grade??"LOW",documents:a}},m=r=>{const a=(r??[]).map(e=>p(e)).filter(e=>!!e);return a.length===0?[{grade:"LOW",documents:[...P]}]:a},d=r=>({interestType:r.interestType,rateType:r.rateType,baseRate:r.baseRate,config:{parameters:(r.config?.parameters??[]).map(a=>({name:a.name,value:a.value,interestRate:a.interestRate}))},policies:(r.policies??[]).map(a=>({interestCategory:a.interestCategory,interestRate:a.interestRate}))}),I=(r=0)=>({interestType:"REDUCING",rateType:"FIXED",baseRate:r,config:{parameters:[]},policies:[]}),k=r=>{if(r.interestRatePlans&&r.interestRatePlans.length>0)return(r.interestRatePlans??[]).map(d);const e=typeof r.baseInterestRate=="number"?r.baseInterestRate:0;return[d(I(e))]};function c(r){const a=k(r);return{...r,loanTenor:{...r.loanTenor,TenorValue:[...r.loanTenor.TenorValue]},interestRatePlans:a,baseInterestRate:a[0]?.baseRate??r.baseInterestRate}}const g=i()(R((r,a)=>({setups:{},addSetup:e=>{const t=(e.channels??[]).map(n=>({name:n.name.trim(),code:n.code.trim()})).filter(n=>n.name||n.code),o=m(e.documentRequirements),l={id:f(),createdAt:Date.now(),product:c(e.product),channels:t,scorecardId:e.scorecardId??null,scorecardName:e.scorecardName??null,workflowId:e.workflowId??null,workflowName:e.workflowName??null,riskGrade:e.riskResult?.riskGrade??null,documentRequirements:o,totalScore:e.riskResult?.totalScore??null,disbursementType:e.disbursementType??"FULL",partialInterestRate:e.disbursementType==="PARTIAL"?e.partialInterestRate??null:null,disbursementDestinations:(e.disbursementDestinations??[]).filter(n=>n?.type==="BANK"||n?.type==="WALLET"),repaymentPlanId:e.repaymentPlan?.planId??null,repaymentPlanName:e.repaymentPlan?.name??null,repaymentPlan:e.repaymentPlan?{...e.repaymentPlan}:null,bureauCheckRequired:e.bureauCheckRequired||!1,bureauConsentRequired:e.bureauConsentRequired||!1,bureauProvider:e.bureauProvider||null,bureauPurpose:e.bureauPurpose||null};return r(n=>({setups:{...n.setups,[l.id]:l}})),l},updateSetup:(e,t)=>{const o=a().setups[e];if(!o)return;const l=(t.channels??[]).map(s=>({name:s.name.trim(),code:s.code.trim()})).filter(s=>s.name||s.code),n=t.documentRequirements!==void 0?m(t.documentRequirements):o.documentRequirements.map(s=>({grade:s.grade,documents:[...s.documents]})),u={...o,product:c(t.product),channels:l,scorecardId:t.scorecardId??null,scorecardName:t.scorecardName??null,workflowId:t.workflowId??null,workflowName:t.workflowName??null,riskGrade:t.riskResult?.riskGrade??o.riskGrade,documentRequirements:n,totalScore:t.riskResult?.totalScore??o.totalScore,disbursementType:t.disbursementType??"FULL",partialInterestRate:t.disbursementType==="PARTIAL"?t.partialInterestRate??null:null,disbursementDestinations:(t.disbursementDestinations??[]).filter(s=>s?.type==="BANK"||s?.type==="WALLET"),repaymentPlanId:t.repaymentPlan?.planId??null,repaymentPlanName:t.repaymentPlan?.name??null,repaymentPlan:t.repaymentPlan?{...t.repaymentPlan}:null,bureauCheckRequired:t.bureauCheckRequired||!1,bureauConsentRequired:t.bureauConsentRequired||!1,bureauProvider:t.bureauProvider||null,bureauPurpose:t.bureauPurpose||null};r(s=>({setups:{...s.setups,[e]:u}}))},resetStore:()=>r({setups:{}})}),{name:"loan-workflow-setups",version:4,migrate:(r,a)=>{if(!r)return{setups:{}};let e=r;if(a<2){const t=e.setups??{},o=Object.entries(t).map(([l,n])=>n?.product?[l,{...n,product:c(n.product)}]:[l,n]);e={...e,setups:Object.fromEntries(o)}}if(a<4){const t=e.setups??{},o=Object.entries(t).map(([l,n])=>{if(!n)return[l,n];const u=m(n.documentRequirements??(n.requiredDocuments?[{grade:n.documentRiskGrade??n.riskGrade??"LOW",documents:n.requiredDocuments}]:void 0));return[l,{...n,documentRequirements:u}]});e={...e,setups:Object.fromEntries(o)}}return e},partialize:r=>({setups:r.setups})}));function L(r){return Object.values(r).sort((a,e)=>e.createdAt-a.createdAt)}export{P as D,b as T,c,L as g,g as u};
